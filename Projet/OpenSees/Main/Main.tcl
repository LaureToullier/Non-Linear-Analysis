# Model1.tcl

wipe all; 
logFile "Model1.log" 
set dataDir Results;			# name of output folder
file mkdir $dataDir;											# create output folder 
set systemTime [clock seconds] 

puts "===============================================================================" 
puts "OpenSees Navigator: Version 2.6.0" 
puts "File sourced: Z:/Non linear analysis/Final project/Model1/Model1.tcl" 
puts "Starting OpenSees analysis: [clock format $systemTime -format "%d-%b-%Y %H:%M:%S"]" 
puts "===============================================================================" 

puts "\n########################" 
puts   "# Analysis-Sequence  1 #"
puts   "########################" 

# Start timing of this analysis sequence 
# -------------------------------------- 
set tStart [clock clicks -milliseconds] 

# Start of model generation 
# ========================= 

# Create ModelBuilder 
# ------------------- 
model  BasicBuilder  -ndm  2  -ndf  3 

# Define geometry 
# --------------- 
# Node   tag       xCrd           yCrd       ndf 
node       1  +0.000000E+00  +0.000000E+00  -ndf 3 
node       2  +0.000000E+00  +0.000000E+00  -ndf 3 
node       3  +0.000000E+00  +3.901000E+03  -ndf 3 
node       4  +0.000000E+00  +3.901000E+03  -ndf 3 

# Define single point constraints 
# ------------------------------- 
# SPC   tag    Dx    Dy    Rz 
fix       1     1     1     1 
fix       4     0     0     1  

#Constraint equal dof  
# -------------------------------------
# SPC   tagr    tagc    doftag1 doftag2  
equalDOF   1       2          1       2
equalDOF   4       3          1       2

# Define material(s) 
# ------------------ 
# Material "ConstitutiveMat":    matTag    eps1  sig1    eps2  sig2    ...  
uniaxialMaterial  MultiLinear       1  +2.000000E-03 +5.800000E+01  +2.000000E-02 +7.250000E+01 

# Material "CyclicMat":    matTag    K0    alpha_Pos    alpha_Neg    My_Pos    My_Neg    Lamda_S    Lamda_C    Lamda_A    Lamda_K    c_S    c_C    c_A    c_K    theta_p_Pos    theta_p_Neg    theta_pc_Pos    theta_pc_Neg    Res_Pos    Res_Neg    theta_u_Pos    theta_u_Neg    D_Pos    D_Neg    <nFactor> 
uniaxialMaterial  Bilin       2  +4.062512E+08  +3.440000E-02  +3.440000E-02  +2.760668E+06  -2.760668E+06  +5.119000E-01  +5.119000E-01  +5.119000E-01  +5.119000E-01  +1.000000E+00  +1.000000E+00  +1.000000E+00  +1.000000E+00  +3.355000E-02  +3.355000E-02  +1.328100E-01  +1.328100E-01  +4.200000E-01  +4.200000E-01  +1.500000E-01  +1.500000E-01  +5.688000E-01  +5.688000E-01  +0.000000E+00 

# Material "ElasticDefault":    matTag    E    <eta>    <Eneg>  
uniaxialMaterial  Elastic       3  +1.904810E+02  +0.000000E+00 

# Define section(s) 
# ----------------- 
# Section "ElasticDefault":    secTag    E    A    Iz    <G>    <alpha> 
section  Elastic       1  +2.900000E+01  +1.800000E+02  +4.860000E+03  +1.115400E+04  +8.333333E-01 

# Define geometric transformation(s) 
# ---------------------------------- 
# GeoTran    type    tag    vec_xz 
geomTransf  Corotational       1 
# Other type?

# Define element(s) 
# ----------------- 
# Element "ColumnBody":    eleTag    NodeI    NodeJ    A    E    Iz    geoTranTag    <alpha  d>    <-mass massDens>    <-cMass> 
element  elasticBeamColumn       1       2       3  +2.774200E+04  +1.904810E+02  +1.906340E+09     1  +0.000000E+00  +0.000000E+00  -mass +0.000000E+00 

# Element "ZeroLMzPlast":    eleTag    NodeI    NodeJ    -mat matTag1 matTag2 ...    -dir dir1 dir2 ...    <-orient x1 x2 x3 y1 y2 y3>    <-doRayleigh flag> 
element  zeroLength       2       1       2  -mat 3  3  2  -dir 1  2  6 -orient +0.000000E+00 +1.000000E+00 +0.000000E+00  -1.000000E+00 -0.000000E+00 -0.000000E+00 

# Element "ZeroLMzPlast":    eleTag    NodeI    NodeJ    -mat matTag1 matTag2 ...    -dir dir1 dir2 ...    <-orient x1 x2 x3 y1 y2 y3>    <-doRayleigh flag> 
element  zeroLength       3       3       4  -mat 3  3  2  -dir 1  2  6 -orient +0.000000E+00 +1.000000E+00 +0.000000E+00  -1.000000E+00 -0.000000E+00 -0.000000E+00 

# Define time series 
# ------------------ 
# TimeSeries "LinearDefault":    tsTag    cFactor 
timeSeries  Linear       1  -factor +1.000000E+00 

# Start of analysis generation 
# ============================ 

# Get initial stiffness 
# --------------------- 
initialize 

puts "o Analysis: AxialLoading" 
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 

# Define load pattern 
# ------------------- 
set Py 11411.0; # Axial resistance of column in (kN)

pattern Plain 1 Linear {
	load 4 0.0 [expr -0.2*$Py] 0.0  

}

# Define recorder(s) 
# ------------------ 
# BeamColumn Recorder "ColumnRecorder":    fileName    <eleTag>    arguments 
recorder  Element  -file AxialLoading_BeamColumn_ColumnRecorder_GlbForc.txt  -time  -ele 1  force 
recorder  Element  -file AxialLoading_BeamColumn_ColumnRecorder_LocForc.txt  -time  -ele 1  localForce 

# Node Recorder "DefoShape":    fileName    <nodeTag>    dof    respType 
recorder  Node  -file AxialLoading_Node_DefoShape_Dsp.txt  -time  -nodeRange 1  4  -dof 1  2  3  disp 

# Node Recorder "EigenVectors":    fileName    <nodeTag>    dof    respType 

# Node Recorder "Reactions":    fileName    <nodeTag>    dof    respType 
recorder  Node  -file AxialLoading_Node_Reactions_RFrc.txt  -time  -nodeRange 1  4  -dof 1  2  3  reaction 

# Node Recorder "TopNodesRecorder":    fileName    <nodeTag>    dof    respType 
recorder  Node  -file AxialLoading_Node_TopNodesRecorder_Dsp.txt  -time  -node 3  4  -dof 1  2  3  disp 

# ZeroLength Recorder "ZeroLRecorder":    fileName    <eleTag>    arguments 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_GlbForc.txt  -time  -ele 2  3  force 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_BasForc.txt  -time  -ele 2  3  basicForce 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_BasDefo.txt  -time  -ele 2  3  deformation 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_MatSig_1.txt  -time  -ele 2  3 material 1 stress 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_MatSig_2.txt  -time  -ele 2  3 material 2 stress 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_MatSig_3.txt  -time  -ele 2  3 material 3 stress 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_MatEps_1.txt  -time  -ele 2  3 material 1 strain 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_MatEps_2.txt  -time  -ele 2  3 material 2 strain 
recorder  Element  -file AxialLoading_ZeroLength_ZeroLRecorder_MatEps_3.txt  -time  -ele 2  3 material 3 strain 

# Define analysis options 
# ----------------------- 
# Gravity-analysis parameters -- load-controlled static analysis
set Tol 1.0e-10;			# convergence tolerance for test
constraints Plain;     		# how it handles boundary conditions
numberer Plain;				# renumber dof's to minimize band-width (optimization), if you want to
system  BandGeneral;		# how to store and solve the system of equations in the analysis
test RelativeNormUnbalance $Tol 20 2; 		# determine if convergence has been achieved at the end of an iteration step
algorithm Newton;			# use Newton's solution algorithm: updates tangent stiffness at every iteration
set NstepGravity 10;  		# apply gravity in 10 steps
set DGravity [expr 1./$NstepGravity]; 	# first load increment;
integrator LoadControl $DGravity;	# determine the next time step for an analysis
analysis Static;			# define type of analysis static or transient

# Record initial state of model 
# ----------------------------- 
record

# Analyze model 
# ------------- 
analyze $NstepGravity;

# Maintain constant gravity loads and reset time to zero
# ------------- 
loadConst -time 0.0

puts "Model Built"

# ######################### STATIC PUSHOVER ANALYSIS #######################

puts "Running Analysis..."

# Assign lateral loads and create load pattern
# ------------- 
  set CtrlNode 4;
  set CtrlDOF 1;
  pattern Plain 200 Linear {			
	 load $CtrlNode 1.0 0.0 0.0;
  }

# Define recorder(s) 
# ------------------ 
# BeamColumn Recorder "ColumnRecorder":    fileName    <eleTag>    arguments 
recorder  Element  -file AxialLoading_BeamColumn_ColumnRecorder_GlbForc.out  -time  -ele 1  force 
recorder  Element  -file AxialLoading_BeamColumn_ColumnRecorder_LocForc.out  -time  -ele 1  localForce 

# Node Recorder "DefoShape":    fileName    <nodeTag>    dof    respType 
recorder  Node  -file AxialLoading_Node_DefoShape_Dsp.out  -time  -nodeRange 1  4  -dof 1  2  3  disp 

# Node Recorder "EigenVectors":    fileName    <nodeTag>    dof    respType 

# Node Recorder "Reactions":    fileName    <nodeTag>    dof    respType 
recorder  Node  -file AxialLoading_Node_Reactions_RFrc.out  -time  -nodeRange 1  4  -dof 1  2  3  reaction 

# Node Recorder "TopNodesRecorder":    fileName    <nodeTag>    dof    respType 
recorder  Node  -file AxialLoading_Node_TopNodesRecorder_Dsp.out  -time  -node 2  4  -dof 1  2  3  disp 

# ZeroLength Recorder "ZeroLRecorder":    fileName    <eleTag>    arguments 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_GlbForc.out  -time  -ele 2  3  force 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_BasForc.out  -time  -ele 2  3  basicForce 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_BasDefo.out  -time  -ele 2  3  deformation 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_MatSig_1.out  -time  -ele 2  3 material 1 stress 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_MatSig_2.out  -time  -ele 2  3 material 2 stress 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_MatSig_3.out  -time  -ele 2  3 material 3 stress 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_MatEps_1.out  -time  -ele 2  3 material 1 strain 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_MatEps_2.out  -time  -ele 2  3 material 2 strain 
recorder  Element  -file Pushover_ZeroLength_ZeroLRecorder_MatEps_3.out  -time  -ele 2  3 material 3 strain 
  
# Analysis commands
# ------------- 
	constraints Plain;					# how it handles boundary conditions
	numberer Plain;						# renumber dof's to minimize band-width (optimization)
	system  UmfPack -lvalueFact   10;   # how to store and solve the system of equations in the analysis (large model: try UmfPack)
	set currentTolerance 1.0e-12
	set nIter0 20000;
	# test EnergyIncr $currentTolerance $nIter0;		# type of convergence criteria with tolerance, max iterations
	#test RelativeNormUnbalance $currentTolerance $nIter0;
	test NormDispIncr $currentTolerance $nIter0;	
	#algorithm KrylovNewton;					# use Newton's solution algorithm: updates tangent stiffness at every iteration
	#algorithm ModifiedNewton -initial
	#algorithm NewtonLineSearch;
	#algorithm Newton;	
	#algorithm BFGS;
	#algorithm SecantNewton
	#algorithm NewtonLineSearch -type Bisection 0.75;
	set algo "ModifiedNewton";
	set algoOptions "-initial";
	# set algo "KrylovNewton";
	# set algoOptions "";
	algorithm $algo $algoOptions;

# Cyclic run -- we will run a loop over each displacement increment (top in-plane displacement in (mm))
# ------------- 
set disp [list 0	0	0.002306582	0.185253331	0.68884698	1.199789229	1.700077672	2.197553171	2.702790778	3.195027821	3.701253328	4.202547483	4.702671431	5.204450339	5.706467666	6.200432777	6.705639884	7.202733308	7.705636788	8.204491809	8.708126843	9.20649711	9.709964506	10.211532	10.71007643	11.20895706	11.71093434	12.20743731	12.71003205	13.21177743	13.70919961	14.20686115	14.6470163	14.14282806	13.63623142	13.13427277	12.62803655	12.12479267	11.62141841	11.12673152	10.62208787	10.12176648	9.622375481	9.125509299	8.621896617	8.121283725	7.620548364	7.120650727	6.622000597	6.117715035	5.618236959	5.116965622	4.614579957	4.114624579	3.617711132	3.120162524	2.616277663	2.117484109	1.611725893	1.11758674	0.61077025	0.112076043	-0.387506036	-0.885382178	-1.383463736	-1.88963348	-2.387220273	-2.891208511	-3.391623264	-3.891156055	-4.394510761	-4.890399519	-5.389396567	-5.895863753	-6.389743648	-6.891174708	-7.390694227	-7.893861271	-8.395420387	-8.896860294	-9.397573769	-9.896427393	-10.39507519	-10.90190466	-11.39970124	-11.90021168	-12.3944683	-12.90187612	-13.39599304	-13.90142925	-14.40197509	-14.65009712	-14.11892753	-13.60667311	-13.10092863	-12.59942167	-12.09550165	-11.59541029	-11.09584514	-10.59929188	-10.09511389	-9.596434422	-9.08808317	-8.593800478	-8.091698401	-7.593965624	-7.089896593	-6.587535609	-6.093028467	-5.591678899	-5.089374259	-4.583976232	-4.086208995	-3.587870859	-3.083038377	-2.588017145	-2.090830822	-1.587635721	-1.084935036	-0.588692259	-0.080051424	0.417926349	0.919346057	1.416363055	1.922562253	2.41680583	2.918354003	3.422390204	3.915730398	4.419802222	4.922446329	5.421856418	5.921260919	6.422633305	6.922511384	7.421455812	7.921222597	8.428373374	8.923837915	9.423784912	9.9230716	10.42615157	10.92346199	11.42806467	11.92429848	12.42733095	12.93006074	13.43106758	13.93091027	14.42512125	14.64367472	14.14627489	13.63962051	13.13238498	12.62885798	12.13055104	11.62895933	11.12907287	10.62533446	10.12409385	9.628340602	9.125480428	8.62515904	8.126972243	7.628170308	7.122619078	6.624197122	6.119915284	5.620730575	5.125496071	4.616547842	4.119407386	3.618994262	3.121461254	2.617499325	2.1187081	1.616585883	1.114334445	0.61349012	0.120018674	-0.387512904	-0.883674307	-1.3845457	-1.883358927	-2.385874512	-2.889068332	-3.387275618	-3.884993726	-4.387605935	-4.89000557	-5.390518811	-5.89153124	-6.392017007	-6.896519102	-7.388957776	-7.890271023	-8.395476267	-8.890653029	-9.394723922	-9.895547293	-10.39468683	-10.89506783	-11.38910837	-11.90457121	-12.3997964	-12.89267838	-13.39577325	-13.89307249	-14.4028049	-14.6478666	-13.88787106	-13.12279329	-12.36661617	-11.61256526	-10.86609717	-10.11099573	-9.356130846	-8.606469259	-7.862952538	-7.109106984	-6.35451125	-5.603262689	-4.853820428	-4.101368599	-3.357417416	-2.60085077	-1.855361392	-1.102235634	-0.347508903	0.402428996	1.147673698	1.900770236	2.652831143	3.405830357	4.151715431	4.904588219	5.652755033	6.401732564	7.155041676	7.908063941	8.657569066	9.40786954	10.15707664	10.90808026	11.66147273	12.41195016	13.16291746	13.91093154	14.66417965	15.41294903	16.16700925	16.91114344	17.66429283	18.41591671	19.16694082	19.5261687	18.75409856	17.99523644	17.23640226	16.48217812	15.73391445	14.98266868	14.23050556	13.4746246	12.72890624	11.97360083	11.22849714	10.47227345	9.719006717	8.974944241	8.218193427	7.467458025	6.717174314	5.965287331	5.215794314	4.470032174	3.714172868	2.961506136	2.209234051	1.46578881	0.715339382	-0.035862995	-0.790050486	-1.535375253	-2.291033976	-3.040885087	-3.792616539	-4.541077185	-5.294815172	-6.041760091	-6.792517845	-7.54802255	-8.290925995	-9.04457923	-9.795445018	-10.55097394	-11.29267085	-12.05947343	-12.80069072	-13.55198398	-14.30254243	-15.05024265	-15.80334827	-16.55450277	-17.29942858	-18.05846579	-18.80359463	-19.53213662	-19.53213662	-18.75731163	-17.99477823	-17.24585891	-16.48076065	-15.72935656	-14.98477161	-14.22741171	-13.48094549	-12.72857469	-11.97560318	-11.22666337	-10.4767736	-9.719851427	-8.971231058	-8.222592995	-7.47088436	-6.721182726	-5.970430095	-5.220179446	-4.471380729	-3.72022111	-2.965354361	-2.2197566	-1.467191963	-0.713054615	0.034849629	0.790700607	1.537924632	2.288616728	3.038772615	3.786341986	4.537293687	5.286822096	6.037114188	6.794689689	7.540817373	8.290737867	9.047510102	9.792000987	10.54410357	11.29748859	12.05076091	12.79695146	13.54596484	14.29823972	15.05042426	15.80104791	16.55348018	17.29917526	18.05330999	18.80114339	19.52849515	19.52849515	18.75597611	17.99585484	17.24176668	16.48609154	15.73235728	14.9849467	14.23413213	13.47755175	12.72802427	11.97870634	11.23023964	10.47563646	9.726895019	8.973793127	8.22101254	7.477004081	6.72030868	5.974519067	5.218760576	4.472174216	3.718720283	2.969720401	2.216222696	1.468490809	0.7095412	-0.032648124	-0.780679926	-1.532993861	-2.283395501	-3.037142102	-3.784830682	-4.533978645	-5.28872665	-6.039607339	-6.790617015	-7.541134022	-8.291263133	-9.041786194	-9.790551849	-10.54434013	-11.29283104	-12.04557903	-12.79397029	-13.54572456	-14.29819688	-15.04899282	-15.79689607	-16.55197516	-17.29731448	-18.05132441	-18.80481467	-19.52653937	-19.52653937	-18.25013757	-16.98073	-15.72086848	-14.46379907	-13.21563404	-11.95823401	-10.71011927	-9.456549771	-8.205287158	-6.954391953	-5.703601055	-4.457275383	-3.200111911	-1.94938702	-0.697844545	0.553801365	1.803296735	3.0521648	4.30771336	5.553402472	6.807265338	8.057113737	9.310034104	10.56031417	11.81022357	13.06098606	14.31645639	15.56317136	16.81705005	18.0726517	19.32219043	20.56843415	21.82110585	23.07457663	24.32518639	25.57355352	26.82755515	28.08061056	29.28933874	29.28933874	28.01650949	26.7455522	25.48637055	24.22977611	22.97704853	21.73317224	20.47565579	19.22014914	17.9724358	16.71766303	15.47357161	14.21707589	12.96480093	11.71102747	10.46249084	9.212080389	7.967106067	6.706939079	5.45900315	4.204405472	2.949045505	1.70369714	0.452973909	-0.79868536	-2.044062596	-3.300298238	-4.552749917	-5.806368776	-7.053102832	-8.307075128	-9.559318423	-10.80934424	-12.06211187	-13.31215631	-14.56220262	-15.81350528	-17.06238464	-18.31557415	-19.5674058	-20.81401646	-22.07113989	-23.32063206	-24.57341552	-25.82485229	-27.07934193	-28.32977287	-29.29749526	-28.02750282	-26.74802579	-25.48917942	-24.23126623	-22.98007347	-21.72708698	-20.47096379	-19.22419854	-17.96827838	-16.72214828	-15.47157019	-14.22167104	-12.96444144	-11.71359047	-10.46408247	-9.214065969	-7.963598706	-6.712157279	-5.458558444	-4.207813647	-2.956189681	-1.709461096	-0.457506452	0.796401815	2.044601366	3.297574352	4.547414836	5.796296988	7.050981745	8.302588016	9.551956318	10.80558356	12.05206942	13.305136	14.55954276	15.81354067	17.06444286	18.31453107	19.56464164	20.81521414	22.06335962	23.32094125	24.56941828	25.82110092	27.07211673	28.32567133	29.29022163	28.0226022	26.75427683	25.4904516	24.23420362	22.97937125	21.73748985	20.48280276	19.22858879	17.97752082	16.72563329	15.47640376	14.22100142	12.97005918	11.72039472	10.46503522	9.217889979	7.96580594	6.7184004	5.45891514	4.211497027	2.959204372	1.705266652	0.457471062	-0.792330829	-2.045945497	-3.293130314	-4.548555706	-5.800678395	-7.049282547	-8.301896974	-9.550607763	-10.80527715	-12.05513347	-13.3062182	-14.55863379	-15.80498926	-17.06029661	-18.31090078	-19.56239901	-20.81363089	-22.0633354	-23.314422	-24.56363849	-25.81513487	-27.07150951	-28.31927501	-29.29603495	-27.97953412	-26.7036669	-25.44231154	-24.18536507	-22.93459885	-21.67984843	-20.42805217	-19.18130368	-17.92893186	-16.6782178	-15.42606857	-14.17394727	-12.92316988	-11.66977827	-10.42126212	-9.166839533	-7.91768916	-6.667963229	-5.415544845	-4.161209334	-2.910308307	-1.662788796	-0.410417939	0.836711726	2.090482973	3.340039868	4.594485741	5.845945328	7.094465662	8.344984613	9.598447941	10.84880065	12.09842693	13.34982552	14.60357942	15.8567559	17.1068199	18.35788228	19.60741915	20.85967176	22.10996859	23.36446196	24.6104449	25.8640293	27.11747028	28.36459503	29.29387428	28.02988701	26.75695717	25.49661323	24.24508147	22.99013175	21.74248919	20.48339136	19.23622936	17.98422448	16.7299211	15.47640469	14.22808878	12.97459658	11.72463968	10.46779566	9.218719788	7.969466038	6.717129145	5.469788332	4.220046103	2.970002359	1.711399294	0.460331503	-0.789651182	-2.042104024	-3.2907282	-4.541809671	-5.793116521	-7.041751873	-8.292602375	-9.545672685	-10.80142148	-12.0430151	-13.2986661	-14.54807259	-15.80706425	-17.05356874	-18.3063522	-19.55432631	-20.80815099	-22.05337025	-23.31172675	-24.5577544	-25.80998838	-27.06373297	-28.31271477	-29.29560468	-28.03708613	-26.76221542	-25.50146915	-24.23998713	-22.98913337	-21.74181305	-20.4852391	-19.23285052	-17.98262633	-16.73092321	-15.48511256	-14.22505919	-12.98163179	-11.72675285	-10.47605835	-9.226732887	-7.972973399	-6.723090075	-5.474395584	-4.219374619	-2.966564381	-1.717511332	-0.468194834	0.783287338	2.038119826	3.287727945	4.536527675	5.786760245	7.039753255	8.291101083	9.544518776	10.79339255	12.0466603	13.29633407	14.5487627	15.80074057	17.05298014	18.30582507	19.55362409	20.80472559	22.05180936	23.30703847	24.55645241	25.80476552	27.05425583	28.31096761	29.29547243	28.03427726	26.76489577	25.49959533	24.24736135	22.99119718	21.74615115	20.49285732	19.23865452	17.98707806	16.73904993	15.48305899	14.23362922	12.98288256	11.73012052	10.47796104	9.227667004	7.972373627	6.722141523	5.471390672	4.22676187	2.972441027	1.717538107	0.464510958	-0.783857249	-2.035408746	-3.28505924	-4.538931884	-5.788193084	-7.035824005	-8.289357647	-9.541425854	-10.79121698	-12.04455458	-13.29236571	-14.54491727	-15.80367237	-17.05537364	-18.29905994	-19.55724508	-20.80646716	-22.05547132	-23.30591716	-24.55407381	-25.80739371	-27.05687284	-28.30527164	-29.29513156	-27.29057521	-25.25382303	-23.23849499	-21.23471536	-19.22525652	-17.22386666	-15.22174664	-13.2195903	-11.2182023	-9.21693258	-7.213087752	-5.211015232	-3.204879351	-1.210088609	0.789188081	2.797733061	4.798765294	6.798156537	8.801246993	10.80192905	12.80699577	14.80558608	16.81045443	18.80845055	20.80956288	22.81505987	24.81985465	26.81551687	28.8191773	30.82191199	32.82511607	34.82333571	36.82666644	38.83013874	39.0602313	36.98997945	34.95384008	32.93408826	30.92918731	28.92627753	26.94537491	24.91397783	22.90811948	20.91113664	18.90898496	16.90930873	14.90520127	12.90200092	10.8989263	8.900566958	6.897012237	4.890788812	2.88923271	0.892540731	-1.115802093	-3.116983455	-5.113993771	-7.111024577	-9.119464085	-11.12208422	-13.12391087	-15.12031071	-17.12658815	-19.12787557	-21.13007195	-23.13204855	-25.13107471	-27.13210322	-29.14074063	-31.13794886	-33.14122185	-35.14702618	-37.14988753	-39.06541318	-39.06541318	-36.99075058	-34.95765105	-32.93828294	-30.92752583	-28.92434411	-26.92027017	-24.91956018	-22.91467413	-20.91113105	-18.91043596	-16.91053063	-14.90495726	-12.90631946	-10.90817153	-8.899274282	-6.898924243	-4.89909621	-2.896456514	-0.895150064	1.107381773	3.109773388	5.11288736	7.111544721	9.1156587	11.1138178	13.11726216	15.12055472	17.12129824	19.12409812	21.1242158	23.12493697	25.12879856	27.13337354	29.13425304	31.13644198	33.13812241	35.13902798	37.13852167	39.06648979	39.06648979	36.99890524	34.95759144	32.9448618	30.93303181	28.93425152	26.93228237	24.93845299	22.91144244	20.91324143	18.91297288	16.91172272	14.91101179	12.91108783	10.90840623	8.903779089	6.905355025	4.901200067	2.899340354	0.899181177	-1.10278232	-3.099276684	-5.10548614	-7.113389671	-9.113186039	-11.11425273	-13.11523095	-15.1184462	-17.119091	-19.11987737	-21.12252079	-23.12562242	-25.12490563	-27.12891437	-29.12992612	-31.1342366	-33.13039243	-35.13482586	-37.13953495	-39.06478733	-39.06478733	-37.00608015	-34.96322781	-32.94432908	-30.93554266	-28.93234603	-26.92926861	-24.92335811	-22.92395011	-20.92161402	-18.92058179	-16.91506617	-14.91343975	-12.91164663	-10.91022138	-8.906996809	-6.906020455	-4.904929549	-2.904776949	-0.898711907	1.099950052	3.100196365	5.103147589	7.101846859	9.105931036	11.11109089	13.1083075	15.1117621	17.11188257	19.11574975	21.12340182	23.12313393	25.1219254	27.12311596	29.12762389	31.12827614	33.12790021	35.13144702	37.13529557	39.05984759	39.05984759	37.00294718	34.965951	32.9503864	30.93821183	28.93741615	26.9468613	24.95829016	22.91766368	20.92208341	18.92914064	16.91986993	14.91947658	12.91879546	10.91828477	8.916649036	6.910896394	4.908196628	2.90765008	0.903532724	-1.096819062	-3.098004032	-5.100254901	-7.102649193	-9.103733115	-11.11064572	-13.10833357	-15.11159725	-17.10951887	-19.1118978	-21.11468092	-23.11664447	-25.12020431	-27.1196682	-29.12234515	-31.1299637	-33.12214464	-35.12588888	-37.12754697	-39.06755149	-39.06755149	-37.00967133	-34.97061133	-32.95398131	-30.9412051	-28.93856913	-26.9381199	-24.93532188	-22.93410525	-20.93002945	-18.927522	-16.92629419	-14.92177229	-12.92073075	-10.92062891	-8.918042295	-6.919313688	-4.917210899	-2.915406134	-0.913374359	1.089241588	3.095126711	5.095437635	7.098379079	9.09874402	11.10243518	13.10330164	15.10612201	17.11051725	19.10409331	21.11283131	23.11248332	25.11239238	27.11404487	29.11304682	31.12014569	33.12226757	35.12427211	37.12524101	39.06220943	39.06220943	37.01287135	34.97270867	32.95552358	30.95228784	28.94602343	26.94641799	24.96385202	22.92728238	20.92845179	18.93382706	16.92890935	14.92914278	12.92627212	10.92902292	8.92367214	6.921958644	4.913345911	2.915330697	0.912620802	-1.087205019	-3.089708509	-5.090196151	-7.093432359	-9.094109759	-11.10385451	-13.09932861	-15.10179788	-17.09991507	-19.10226233	-21.10702917	-23.10547419	-25.10798909	-27.11462043	-29.1139856	-31.11428767	-33.11491385	-35.12177616	-37.12892905	-39.06407952	-39.06407952	-35.98663211	-32.94792399	-29.93076667	-26.91132016	-23.90367724	-20.90441063	-17.89725013	-14.89455998	-11.89215388	-8.890844882	-5.889793392	-2.883670852	0.121352648	3.119793488	6.124647334	9.131050669	12.12704182	15.13759233	18.12939718	21.14074118	24.14144203	27.1425806	30.14254943	33.15009922	36.15318239	39.15775567	42.1541594	45.15805468	48.16868156	51.17020756	54.16757613	57.17331916	58.58997256	55.59405684	52.54095793	49.51358587	46.50571942	43.51464659	40.48206657	37.48014569	34.47732329	31.47548065	28.47340144	25.4762806	22.46670052	19.46318522	16.46312699	13.46417703	10.45337599	7.450493518	4.45446698	1.449196017	-1.551852212	-4.554944579	-7.559035905	-10.56221686	-13.56920321	-16.56868123	-19.57219094	-22.57169597	-25.57691745	-28.58103067	-31.58606589	-34.58970785	-37.59007156	-40.59374332	-43.59700531	-46.59753665	-49.60278794	-52.6028499	-55.61039224	-58.59635398	-58.59635398	-55.59925735	-52.54308879	-49.51830581	-46.50329053	-43.4987098	-40.49376771	-37.48813272	-34.48551893	-31.48291633	-28.47832441	-25.47377534	-22.47879468	-19.47288401	-16.47062413	-13.46788276	-10.46257839	-7.455708925	-4.457028117	-1.458100043	1.547669061	4.545700736	7.554292679	10.55428293	13.55980244	16.56555571	19.56298016	22.56711014	25.57438985	28.57906558	31.57725558	34.58178043	37.58547083	40.58857635	43.58901829	46.59291357	49.59338158	52.59818211	55.60456589	58.58930945	58.58930945	55.60649186	52.55063251	49.52649027	46.51426151	43.51933673	40.4933095	37.48708591	34.48777273	31.48787469	28.48279104	25.48329718	22.47958072	19.47479509	16.47359692	13.473331	10.46379097	7.461565081	4.457823467	1.455879072	-1.544894534	-4.545155913	-7.546386216	-10.55078488	-13.55385408	-16.55945554	-19.55508441	-22.56336249	-25.566075	-28.57287228	-31.57511353	-34.57652032	-37.57889941	-40.5809544	-43.59006137	-46.59525305	-49.5887883	-52.59324983	-55.5976741	-58.59022215	-58.59022215	-54.86692116	-51.05479434	-47.2757183	-43.51406917	-39.75571319	-35.99934652	-32.24120289	-28.48961391	-24.73233268	-20.98322287	-17.22437143	-13.47215287	-9.721912444	-5.97063452	-2.216102323	1.538674929	5.294905044	9.046357125	12.79869024	16.5494103	20.30766755	24.06029403	27.8140381	31.56436607	35.3208296	39.07914832	42.83325747	46.58598825	50.33362284	54.09407988	57.84546956	61.60285696	65.35747647	69.11059469	72.86313921	76.61368698	78.12159508	74.24961776	70.43602318	66.65255874	62.88639456	59.13558975	55.37261069	51.61643401	47.8650853	44.11652312	40.35492614	36.60460562	32.84701705	29.0928185	25.34104511	21.5884205	17.83647016	14.08508327	10.32808889	6.580025423	2.824547002	-0.929899397	-4.684457555	-8.439529687	-12.19624188	-15.94742946	-19.7048001	-23.45694602	-27.20987983	-30.96489981	-34.72032771	-38.46916184	-42.22597554	-45.97866163	-49.73199964	-53.48883197	-57.23974854	-60.9895885	-64.74693865	-68.50124896	-72.25289196	-76.01083815	-78.11693847	-74.25389439	-70.43880969	-66.65971875	-62.89700419	-59.13619325	-55.38117141	-51.63230002	-47.87296429	-44.11858693	-40.36363959	-36.61136329	-32.86332637	-29.10667844	-25.35063773	-21.59988508	-17.84417778	-14.09067027	-10.3396466	-6.583537441	-2.827649005	0.924934458	4.681268241	8.433942683	12.18707766	15.93936048	19.69070733	23.45235273	27.19985321	30.955052	34.70797464	38.46433759	42.21638292	45.96953094	49.72531646	53.4747988	57.23119155	60.9857142	64.7418201	68.49695742	72.24683464	76.00101829	78.1178996	74.25780594	70.45218349	66.67068601	62.90429831	59.14783105	55.38953468	51.63415149	47.87895456	44.13245991	40.36809132	36.61607578	32.86468983	29.10729498	25.35500191	21.60372399	17.85084233	14.09730129	10.33855975	6.594028324	2.83637899	-0.919175567	-4.668968264	-8.425629698	-12.18215935	-15.93227126	-19.68258619	-23.44319597	-27.19386853	-30.94802052	-34.70297158	-38.4552069	-42.20804945	-45.964811	-49.71503839	-53.47263813	-57.22189322	-60.9777756	-64.72802907	-68.48408282	-72.23575562	-75.98850131	-78.11484486	-72.98260182	-67.914024	-62.87670135	-57.85971135	-52.85191908	-47.8435047	-42.8384766	-37.83305734	-32.83168375	-27.82053314	-22.81593345	-17.81495288	-12.80919369	-7.802553009	-2.799074166	2.205874072	7.21025886	12.21698057	17.21891388	22.22885936	27.2316169	32.23886341	37.24043071	42.24745557	47.25250602	52.25329101	57.25837871	62.27235496	67.2770068	72.27069885	77.28695124	82.28621632	87.28887141	92.29533374	97.30233997	102.3106202	107.3082238	112.3148873	117.1669587	117.1669587	112.0503098	106.9720164	101.9309461	96.91610932	91.89802408	86.89217269	81.89023286	76.88434422	71.87498361	66.8714121	61.86404824	56.86445162	51.85755715	46.85756937	41.85054451	36.84171289	31.8389535	26.83138289	21.8313951	16.8228671	11.82107814	6.810589228	1.807603519	-3.194864141	-8.19856301	-13.20366282	-18.21361296	-23.21853116	-28.22026424	-33.23251382	-38.23284432	-43.23970154	-48.24511707	-53.24027315	-58.2514666	-63.25987726	-68.25843453	-73.2608065	-78.2744512	-83.27713609	-88.2762149	-93.28512102	-98.28682989	-103.2974124	-108.3027199	-113.3057252	-117.1710864	-112.0537817	-106.9780663	-101.945512	-96.92575783	-91.90884978	-86.90577	-81.89894259	-76.88997686	-71.88970596	-66.88012183	-61.88186631	-56.87033013	-51.86542496	-46.86238989	-41.8612659	-36.85281798	-31.85191751	-26.840996	-21.84155025	-16.84145257	-11.82922255	-6.828024518	-1.822188962	3.182984889	8.191256784	13.19344901	18.20261776	23.20903353	28.20820548	33.21442381	38.21951151	43.22890192	48.23313281	53.23352292	58.24211612	63.24747205	68.2522729	73.25817645	78.26071233	83.27070624	88.27073127	93.27292442	98.27779979	103.2907069	108.2870886	113.294661	117.1651781	112.0702326	106.9918871	101.9528508	96.93820775	91.92313999	86.91533655	81.90824091	76.90312713	71.90012187	66.89477712	61.89052016	56.88354746	51.88220367	46.87706009	41.87012836	36.86408326	31.86109662	26.84996463	21.84576355	16.84848592	11.83674019	6.834259257	1.830635592	-3.170323325	-8.180492558	-13.1842522	-18.18731986	-23.19423296	-28.20333466	-33.20120275	-38.20831329	-43.21791604	-48.22197184	-53.22461575	-58.23101103	-63.23833019	-68.24044883	-73.24513048	-78.24811339	-83.25685561	-88.25972676	-93.26443821	-98.26642275	-103.2777131	-108.2824022	-113.2857874	-117.1723232	-112.0858714	-107.0091575	-101.9704491	-96.95204347	-91.94307029	-86.92967892	-81.9285959	-76.92874968	-71.92149013	-66.91201776	-61.91411987	-56.90930411	-51.9005768	-46.89406604	-41.891817	-36.88384593	-31.88041598	-26.87778324	-21.87280357	-16.86077565	-11.86372899	-6.857475732	-1.850869739	3.153791185	8.159860037	13.16076238	18.17052066	23.17737974	28.17981876	33.18371624	38.19048032	43.19176078	48.20073768	53.20546404	58.20640922	63.21699917	68.21557134	73.22438061	78.22661102	83.23405683	88.2364884	93.24326366	98.2491225	103.2508537	108.2623228	113.2599413	118.2677299	123.2678667	128.2788217	133.2823783	138.287127	143.2945579	148.2971162	153.3027887	156.2074125	151.1359662	146.0616738	141.0237253	136.008203	130.9942454	125.9898692	120.9878623	115.9782037	110.9663844	105.967246	100.9619385	95.9603712	90.95301479	85.94621718	80.9411481	75.93569905	70.9323585	65.92785567	60.92276797	55.92116714	50.91345683	45.91311142	40.90857878	35.89869291	30.89069761	25.88965371	20.88116482	15.88062569	10.87477338	5.868330132	0.867397233	-4.143191967	-9.145533666	-14.1499592	-19.15813051	-24.15910363	-29.16439995	-34.1726318	-39.171841	-44.18091103	-49.18645695	-54.18909341	-59.19460952	-64.19687718	-69.2005083	-74.21246171	-79.21374589	-84.22352374	-89.22503889	-94.22853589	-99.23466295	-104.2398065	-109.2488393	-114.2514274	-119.253926	-124.2596507	-129.2627603	-134.2660487	-139.2702609	-144.2814916	-149.2867619	-154.284507	-156.2123448	-151.1518955	-146.0703611	-141.0406679	-136.0229403	-131.0123056	-126.0032058	-120.9958941	-115.9866229	-110.9840646	-105.9859246	-100.9819284	-95.97671777	-90.96686542	-85.95754206	-80.95832169	-75.95477253	-70.94581425	-65.94349444	-60.93502045	-55.93020096	-50.92724785	-45.92251033	-40.91657326	-35.9120965	-30.90747446	-25.90428852	-20.89574747	-15.89703746	-10.88446286	-5.88610163	-0.870958378	4.131888505	9.134013206	14.14017938	19.14415136	24.1495762	29.15503271	34.15461257	39.16314617	44.16684434	49.16999862	54.17696387	59.1831468	64.18329477	69.19495761	74.19478148	79.20129597	84.20439065	89.20894563	94.2139104	99.21789914	104.2259112	109.2319489	114.2340675	119.2376837	124.2438778	129.2487383	134.2534423	139.2614394	144.2634612	149.2722929	154.2706192	156.2035978	151.1594355	146.0913122	141.0514116	136.0387057	131.0249716	126.0189861	121.0076734	116.0084605	110.9999344	105.994083	100.9894758	95.98778933	90.98061919	85.9760046	80.97029477	75.96670836	70.96279413	65.95717371	60.94929948	55.94880134	50.9429723	45.93744501	40.93280807	35.92943028	30.92606738	25.91189742	20.91292292	15.90928994	10.90488583	5.897391122	0.89187175	-4.110871349	-9.118452668	-14.12070636	-19.12789978	-24.13762175	-29.13660184	-34.14292261	-39.15286437	-44.15145144	-49.1512157	-54.1598089	-59.1637902	-64.17711079	-69.17900592	-74.17786866	-79.18937504	-84.18852836	-89.19553459	-94.20175105	-99.20404106	-104.2067558	-109.2146859	-114.2216921	-119.2268506	-124.2278069	-129.2350739	-134.2367679	-139.2448545	-144.2479938	-149.2566168	-154.2584747	-156.210646	-151.1945426	-146.1137235	-141.0776377	-136.0626668	-131.0446858	-126.0420233	-121.0359782	-116.0328016	-111.025162	-106.0220003	-101.0168791	-96.01293504	-91.00410342	-85.99811792	-80.99685609	-75.99249482	-70.99022716	-65.98259509	-60.97669154	-55.97361922	-50.96345022	-45.95666751	-40.96249864	-35.95673665	-30.94992228]

  # Count the number of elements in the list "disp" -- this gives us the length of the loop we will do
  set LoopLength [llength $disp]
  puts "Loop length: "
  puts $LoopLength
  set h 1 


# Run the static cyclic analysis
# ------------- 
  set NSteps 1; # Number of increments during analysis
  set dU1 0;
  set ok 0;
  
  puts "Analysis..."

  while {$ok == 0 && $h < $LoopLength} {
	# List starts with 0 index and goes to index (h-1)
	set index [expr $h]
	# We need the relative deformation of the loading protocol
	# Subtract dUi+1 - dUi
	set D1 [lindex $disp $index]; # Retrieve element $index from list $disp
	set D2 [lindex $disp $index-1];
	set dU1 [expr ($D1-$D2)];
	
	# Create Nsteps from Amplitude to Amplitude
	set dU [expr ($dU1)/$NSteps]
	
	# Displacement Control Integrator -- displacement increment dU is applied at the top node (node 4) in dof 1
	integrator DisplacementControl $CtrlNode $CtrlDOF $dU
	analysis Static
	puts $ok
    puts "increment = [expr {$h}] / [expr {$LoopLength}]";
	 
	# Perform analysis with $NSteps -- analyze returns 0 if succesfull and < 0 if not
	set ok [ analyze $NSteps]
	
	# If unsuccesfull, try other convergence criteria and/or algorithms
	if {$ok != 0} {
	puts "loop 1 to update tol"
    eval "test NormDispIncr [expr $currentTolerance*1000] [expr 2*$nIter0] 0"
	algorithm ModifiedNewton -initial;
	set ok [analyze [expr $NSteps/1]]
 }
	
	if {$ok != 0} {
	puts "loop 2 to update tol"
    eval "test EnergyIncr [expr $currentTolerance*1000] [expr 4*$nIter0] 0"
	algorithm ModifiedNewton -initial;
	set ok [analyze [expr $NSteps/1]]
 }
	
	if {$ok != 0} {
	puts "loop 3 to update tol"
    eval "test EnergyIncr [expr $currentTolerance*1000] $nIter0 0"
	algorithm NewtonLineSearch -type Bisection 0.75;
	set ok [analyze [expr $NSteps/1]]
 }
 
 	if {$ok != 0} {
	puts "loop 4  to update tol"
    eval "test NormDispIncr [expr $currentTolerance*10000] $nIter0 0"
	algorithm NewtonLineSearch -type Bisection 0.75;
	set ok [analyze [expr $NSteps/1]]
 }
 
	if {$ok != 0} {
	puts "loop 5  to update tol"
    eval "test NormDispIncr [expr $currentTolerance*10000000000] $nIter0 0"
	algorithm NewtonLineSearch;
	set ok [analyze [expr $NSteps/1]]
 }
 
  test EnergyIncr $currentTolerance $nIter0;
  algorithm Newton;
  
  # Increment +1
  set h [expr $h + 1 ]
} 

# Stop timing of this analysis sequence 
# ------------------------------------- 
set tStop [clock clicks -milliseconds] 
puts "o Time taken: [expr ($tStop-$tStart)/1000.0] sec" 

# Clean up 
# -------- 
wipe 
set systemTime [clock seconds] 
puts "\n===============================================================================" 
puts "Finished OpenSees analysis: [clock format $systemTime -format "%d-%b-%Y %H:%M:%S"]" 
puts "===============================================================================" 
exit 


